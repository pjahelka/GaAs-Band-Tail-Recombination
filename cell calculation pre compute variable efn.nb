(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     60671,       1396]
NotebookOptionsPosition[     54790,       1302]
NotebookOutlinePosition[     55214,       1319]
CellTagsIndexPosition[     55171,       1316]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<NumericalCalculus`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.973802182237506*^9, 3.973802182237506*^9}},
 CellLabel->
  "In[811]:=",ExpressionUUID->"ab6e992b-1046-458c-b4e6-e0be4a679265"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Physical Constants and Parameters", "Section"]], \
"Chapter",
 CellChangeTimes->{{3.9737032272834215`*^9, 
  3.973703235147582*^9}},ExpressionUUID->"78bb56e9-172b-4e6a-98b3-\
fc86e79d1da0"],

Cell["\<\
Length units are cm, mass is gram, time is second, energy is eV, current is mA\
\>", "Text",
 CellChangeTimes->{{3.973703249227517*^9, 3.9737032966990905`*^9}, {
  3.9737033486102896`*^9, 3.9737033505466166`*^9}, {3.9737036808890333`*^9, 
  3.9737036832969613`*^9}},ExpressionUUID->"1729ae9a-9b48-4d0b-a40e-\
d68569e85bdb"],

Cell[CellGroupData[{

Cell["Constants", "Subsection",
 CellChangeTimes->{{3.9737035433608727`*^9, 
  3.9737035456505795`*^9}},ExpressionUUID->"f813bb09-e934-4f0d-ba75-\
a3f0e3dbec09"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", "=", " ", 
   RowBox[{"3", " ", 
    SuperscriptBox["10", "10"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h", "=", " ", 
    RowBox[{"4.14", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "15"}]]}]}], ";"}], 
  RowBox[{"(*", "eVs", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kB", " ", "=", " ", 
    RowBox[{"8.62", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "5"}]]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"eV", "/", "K"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", " ", "=", " ", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kBT", " ", "=", " ", 
   RowBox[{"kB", "*", "T"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q", "=", 
    RowBox[{"1.602", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "16"}]]}]}], ";"}], 
  RowBox[{"(*", "mC", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.973703302687902*^9, 3.973703456066189*^9}, {
   3.973703985062389*^9, 3.9737040093192015`*^9}, {3.973709115443903*^9, 
   3.9737091393241773`*^9}, {3.973709212428099*^9, 3.9737092126828785`*^9}, {
   3.9737113315363274`*^9, 3.973711334786147*^9}, 3.9738834579768887`*^9},
 CellLabel->
  "In[812]:=",ExpressionUUID->"9edb37a7-440e-4a5d-92e2-c30daf472362"]
}, Open  ]],

Cell[CellGroupData[{

Cell["GaAs properties", "Subsection",
 CellChangeTimes->{{3.973703560345626*^9, 
  3.9737035642576714`*^9}},ExpressionUUID->"ced1618c-5b4a-4b9e-bb84-\
d1cd46e1e0ca"],

Cell["Take convention that valence band edge energy is E=0", "Text",
 CellChangeTimes->{{3.9737078416750183`*^9, 
  3.9737078613387794`*^9}},ExpressionUUID->"fef5613e-f248-46ee-9822-\
7bd3d802b46e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cbb", "=", 
    RowBox[{"1.3", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "10"}]]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "GaAs", " ", "radiative", " ", "recombination", " ", "coefficient"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ni", "=", 
    RowBox[{"2", " ", 
     SuperscriptBox["10", "6"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"GaAs", " ", "intrinsic", " ", "carrier", " ", "concentration"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p\[LetterSpace]emit", "=", 
    RowBox[{"8.0", " ", 
     SuperscriptBox["10", "19"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Emitter", " ", "doping", " ", "density"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eu", "=", 
   RowBox[{"1.0", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]], "*", 
    RowBox[{"(", 
     RowBox[{"12", "+", 
      RowBox[{"6", "*", 
       RowBox[{"p\[LetterSpace]emit", "/", 
        SuperscriptBox["10", "19"]}]}]}], ")"}]}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Linear", " ", "fit", " ", "to", " ", "Urbach", " ", "Energy", " ", "vs", " ",
     "doping"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nv", "=", 
    RowBox[{"9.0", " ", 
     SuperscriptBox["10", "18"]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"valence", " ", "band", " ", "density", " ", "of", " ", "states"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nc", "=", 
    RowBox[{"4.7", " ", 
     SuperscriptBox["10", "17"]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "conduction", " ", "band", " ", "density", " ", "of", " ", "states"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "3.5"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Band", " ", "edge", " ", "index", " ", "of", " ", "refraction"}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eg", "=", "1.42"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"unperturbed", " ", "bandgap"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eg\[LetterSpace]emit", "=", 
   RowBox[{"eg", "-", 
    RowBox[{"1.6", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "8"}]], " ", 
     SuperscriptBox["p\[LetterSpace]emit", 
      RowBox[{"1", "/", "3"}]]}]}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Bandgap", " ", "narrowing", " ", "of", " ", "the", " ", "emitter"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]\[LetterSpace]bandgap", "=", "1000.0"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Absorption", " ", "at", " ", "the", " ", "bandgap", " ", "below", " ", 
    "which", " ", "is", " ", "band", " ", 
    RowBox[{"tails", ".", " ", "Used"}], " ", "for", " ", "scaling", " ", 
    "the", " ", "absorption", " ", "calculation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dn", "=", "50"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Electron", " ", "diffusion", " ", "coefficient"}], ",", " ", 
    RowBox[{
    "important", " ", "if", " ", "using", " ", "surface", " ", 
     "recombination"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"srv", "=", "\"\<infinite\>\""}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "can", " ", "be", " ", "\"\<zero\>\"", " ", "or", 
    " ", "\"\<infinite\>\""}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.973703475349989*^9, 3.9737035180901203`*^9}, {
   3.9737036431531005`*^9, 3.973703645257983*^9}, {3.9737073663644404`*^9, 
   3.9737073914290495`*^9}, {3.973707632493515*^9, 3.9737077106274366`*^9}, {
   3.973707900802556*^9, 3.973707902995202*^9}, {3.9737079334504447`*^9, 
   3.973707942297716*^9}, {3.973707990849038*^9, 3.97370801748244*^9}, {
   3.9737082109685073`*^9, 3.973708212649267*^9}, {3.973709947313259*^9, 
   3.973709949527646*^9}, {3.9737103882769165`*^9, 3.973710389869934*^9}, {
   3.9737104314051137`*^9, 3.9737104442699723`*^9}, {3.9737107974769073`*^9, 
   3.973710801819228*^9}, {3.9737115181193953`*^9, 3.973711518383336*^9}, {
   3.9737117741402044`*^9, 3.973711816077838*^9}, 3.9737120387405677`*^9, 
   3.973712250750079*^9, {3.9737128238408585`*^9, 3.9737128246483917`*^9}, {
   3.973712946600416*^9, 3.9737129466799507`*^9}, {3.973713065382784*^9, 
   3.973713065463896*^9}, {3.9737794710710893`*^9, 3.9737795428052616`*^9}, {
   3.9737942044547276`*^9, 3.9737942637149715`*^9}, {3.973794342489558*^9, 
   3.973794343413221*^9}, 3.9737944447066174`*^9, {3.973794493562645*^9, 
   3.973794527601946*^9}, {3.973795540923706*^9, 3.9737955566702423`*^9}, {
   3.9737956005013046`*^9, 3.9737956016444564`*^9}, 3.9737958869458365`*^9, 
   3.9738845060773544`*^9, {3.9739575669109097`*^9, 3.973957566982052*^9}, {
   3.9739576976499767`*^9, 3.9739577296176395`*^9}, {3.973958635441023*^9, 
   3.9739586419696407`*^9}, {3.973959413612398*^9, 3.973959414599764*^9}, {
   3.973959944207033*^9, 3.9739599446801167`*^9}, {3.9739609692900467`*^9, 
   3.9739609696508274`*^9}, {3.9739612470679703`*^9, 
   3.9739612474542007`*^9}, {3.973961613011402*^9, 3.9739616137017574`*^9}, {
   3.9739639533380413`*^9, 3.9739639537276936`*^9}, {3.973964263269186*^9, 
   3.9739642637077713`*^9}, {3.973964558215214*^9, 3.973964558640499*^9}, {
   3.973964887301117*^9, 3.9739648879246883`*^9}, {3.973966360856863*^9, 
   3.9739663756612396`*^9}, 3.973966419539158*^9, {3.973966481394787*^9, 
   3.9739664818482304`*^9}, {3.9739666562225914`*^9, 3.973966692102627*^9}, {
   3.9739669468598385`*^9, 3.9739669525953655`*^9}, {3.9739670397746563`*^9, 
   3.9739670450822105`*^9}, {3.9739671007716427`*^9, 3.973967106831749*^9}, {
   3.9739674441372356`*^9, 3.9739674446050396`*^9}, {3.9739681882821655`*^9, 
   3.9739681887100887`*^9}},
 CellLabel->
  "In[818]:=",ExpressionUUID->"b4e7fd5d-dfa2-462e-bced-2d151fbec9c8"],

Cell[BoxData["0.06`"], "Output",
 CellChangeTimes->{{3.9737944939781165`*^9, 3.973794528622656*^9}, 
   3.9737954596756077`*^9, {3.9737955417005606`*^9, 3.973795557140086*^9}, 
   3.9737956027176914`*^9, 3.9737957566794276`*^9, 3.973795805942822*^9, 
   3.9737958874830585`*^9, 3.973799572579298*^9, 3.9738002051756773`*^9, 
   3.9738008786117134`*^9, 3.9738009873256874`*^9, 3.973801640178601*^9, 
   3.9738631355129347`*^9, 3.9738632175120015`*^9, 3.9738834597522545`*^9, 
   3.9738845071108227`*^9, 3.9739558864926605`*^9, 3.973957567500143*^9, 
   3.9739577302151985`*^9, 3.973958252650938*^9, {3.973958635932831*^9, 
   3.9739586526312523`*^9}, {3.973959415315998*^9, 3.973959419449177*^9}, 
   3.9739599490190544`*^9, 3.973960983680889*^9, 3.9739612924894695`*^9, 
   3.973961617409937*^9, 3.973963957412977*^9, 3.973964266683325*^9, 
   3.973964565964302*^9, {3.9739648887410393`*^9, 3.9739648926151943`*^9}, 
   3.9739663763679256`*^9, 3.9739664203047924`*^9, 3.973966512732275*^9, {
   3.9739670418491096`*^9, 3.973967056965849*^9}, 3.9739671217551956`*^9, 
   3.973967451205511*^9, 3.97396819294944*^9},
 CellLabel->
  "Out[821]=",ExpressionUUID->"09dba031-a9a8-704b-9e3e-8ead6e7ff53a"],

Cell[BoxData["1.3510580899189797`"], "Output",
 CellChangeTimes->{{3.9737944939781165`*^9, 3.973794528622656*^9}, 
   3.9737954596756077`*^9, {3.9737955417005606`*^9, 3.973795557140086*^9}, 
   3.9737956027176914`*^9, 3.9737957566794276`*^9, 3.973795805942822*^9, 
   3.9737958874830585`*^9, 3.973799572579298*^9, 3.9738002051756773`*^9, 
   3.9738008786117134`*^9, 3.9738009873256874`*^9, 3.973801640178601*^9, 
   3.9738631355129347`*^9, 3.9738632175120015`*^9, 3.9738834597522545`*^9, 
   3.9738845071108227`*^9, 3.9739558864926605`*^9, 3.973957567500143*^9, 
   3.9739577302151985`*^9, 3.973958252650938*^9, {3.973958635932831*^9, 
   3.9739586526312523`*^9}, {3.973959415315998*^9, 3.973959419449177*^9}, 
   3.9739599490190544`*^9, 3.973960983680889*^9, 3.9739612924894695`*^9, 
   3.973961617409937*^9, 3.973963957412977*^9, 3.973964266683325*^9, 
   3.973964565964302*^9, {3.9739648887410393`*^9, 3.9739648926151943`*^9}, 
   3.9739663763679256`*^9, 3.9739664203047924`*^9, 3.973966512732275*^9, {
   3.9739670418491096`*^9, 3.973967056965849*^9}, 3.9739671217551956`*^9, 
   3.973967451205511*^9, 3.97396819294944*^9},
 CellLabel->
  "Out[826]=",ExpressionUUID->"17767bdd-bbcd-214a-8af9-19f8b26d82ad"]
}, Open  ]],

Cell["Fermi-Dirac and Bose-Einstein Distributions", "Text",
 CellChangeTimes->{{3.9737075596998587`*^9, 
  3.9737075924758472`*^9}},ExpressionUUID->"00098f11-d26d-439f-a371-\
182a42cbcffa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fd", "[", 
    RowBox[{
     RowBox[{"e_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Mu]_", "?", "NumericQ"}]}], "]"}], ":=", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"e", "-", "\[Mu]"}], ")"}], "/", "kBT"}], "]"}], "+", 
     "1"}]]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"be", "[", 
   RowBox[{
    RowBox[{"e_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Mu]_", "?", "NumericQ"}]}], "]"}], ":=", 
  FractionBox["1", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", "-", "\[Mu]"}], ")"}], "/", "kBT"}], "]"}], "-", 
    "1"}]]}]}], "Input",
 CellChangeTimes->{{3.9737074640167212`*^9, 3.9737074983073554`*^9}, {
  3.9737075946599026`*^9, 3.973707604891652*^9}, {3.973709440074438*^9, 
  3.9737094506904297`*^9}, {3.9737105385969815`*^9, 3.973710565292775*^9}},
 CellLabel->
  "In[830]:=",ExpressionUUID->"876e9714-ea10-413b-bb6a-ef29541e9d91"],

Cell["Find the Hole Fermi level", "Text",
 CellChangeTimes->{{3.9737096864465704`*^9, 3.973709700038155*^9}, {
  3.9737951022333975`*^9, 
  3.973795106868664*^9}},ExpressionUUID->"4d4c98fe-72ac-4043-bb03-\
8f685ee0178f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "[", 
   RowBox[{"efp_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{"nv", 
   FractionBox["2", 
    RowBox[{"Sqrt", "[", "Pi", "]"}]], 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"-", "e"}], "/", "kBT"}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"fd", "[", 
          RowBox[{"e", ",", "efp"}], "]"}]}], ")"}], "/", "kBT"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", 
       RowBox[{"-", "Infinity"}], ",", "0"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9737080279166145`*^9, 3.9737081966750917`*^9}, {
   3.9737082500250797`*^9, 3.9737082701926546`*^9}, {3.973708402008918*^9, 
   3.973708450449194*^9}, 3.9737084836639795`*^9, {3.973708520104704*^9, 
   3.9737085646316433`*^9}, {3.9737086761111774`*^9, 3.973708699350479*^9}, {
   3.9737088420138445`*^9, 3.9737088746123953`*^9}, {3.973709194524514*^9, 
   3.9737092260439177`*^9}, {3.9737093665309687`*^9, 3.9737093667385883`*^9}},
 CellLabel->
  "In[832]:=",ExpressionUUID->"d13148fa-bd05-4747-949f-807bd8f70983"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"efp", "=", 
  RowBox[{
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", "x", "]"}], "==", "p\[LetterSpace]emit"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0"}], "}"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9737082221088204`*^9, 3.9737082297760377`*^9}, {
   3.973708277080958*^9, 3.9737082970404043`*^9}, {3.9737083328883276`*^9, 
   3.973708333328532*^9}, 3.973708411655751*^9, 3.973708602526476*^9, {
   3.973708848997116*^9, 3.9737088493171387`*^9}, {3.9737092401003323`*^9, 
   3.973709255731223*^9}, {3.9737093076750245`*^9, 3.9737093621663294`*^9}, {
   3.973709481130639*^9, 3.9737094824185224`*^9}, {3.973709627617135*^9, 
   3.973709677904754*^9}, {3.9737100861830254`*^9, 3.973710101375247*^9}, {
   3.973710863546858*^9, 3.9737108822977467`*^9}, 3.9737109523730288`*^9, {
   3.9737109870912547`*^9, 3.973710991105093*^9}, {3.9737112577367887`*^9, 
   3.973711279474655*^9}},
 CellLabel->
  "In[833]:=",ExpressionUUID->"549ff1ab-b8fb-4e21-a4f0-a605c99ddf66"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "lstol", 
   "\"The line search decreased the step size to within tolerance specified \
by AccuracyGoal and PrecisionGoal but was unable to find a sufficient \
decrease in the merit function. You may need more than \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) digits of working precision to \
meet these tolerances.\"", 2, 833, 14, 29291565574711164498, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9739681930380783`*^9},
 CellLabel->
  "During evaluation of \
In[833]:=",ExpressionUUID->"58f76cbd-d52c-1d4f-a4ed-cd1193985f6c"],

Cell[BoxData[
 RowBox[{"-", "0.1297667604904856`"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAeL/B39tdZj91tFwteIBEN1ysukKiO4wT7oNoo99OSfh
CKTbMrqVQfS5W1kGIDpjrYo7iDbb87AcRP/6820iiO7583MqiI52nuWYCaTj
Lu91BdFTun2DQHT9g+4VIJrHrPUCiLaTW/QVRNt4n/wNohXOanJkAekd8xde
ygbSLIc2KeYAaa78h6Ug2qeuohlEa7lOvQmi/X90vOsC0ipr5p6eAtK3y8Zn
Koh+uOnHDpB7Hs333QmkC0qm14PoDWsL7oPogMuLFXcB6T9Pfi0C0RMkJp0E
0V+4DT6BaIfTG8T2AOk7ayNsQfSO9weTQPQElmndIHrBQk/vvSD9h6TCQPSb
s1aLQPSJiZmnQXRHvqLGPiANAG/nx6M=
  "],
 CellLabel->
  "Out[833]=",ExpressionUUID->"4e2d81f1-1868-6c4c-a75f-af714a02a436"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Device geometry", "Subsection",
 CellChangeTimes->{{3.973703569610061*^9, 
  3.9737035749219027`*^9}},ExpressionUUID->"e60a959f-3beb-4137-acf3-\
209d2ce9d572"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"We", "=", 
    RowBox[{"100.0", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "7"}]]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Emitter", " ", "Width"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Wd", "=", 
    RowBox[{"200.0", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "7"}]]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Depletion", " ", "Width"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Lp", "=", 
    RowBox[{"10.0", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "4"}]]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Base", " ", "Width"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9737035923253465`*^9, 3.9737036481298647`*^9}, {
  3.973707036784334*^9, 3.9737070515106525`*^9}, {3.9737957055226083`*^9, 
  3.9737957090908527`*^9}, {3.9739575976593647`*^9, 3.973957609935856*^9}},
 CellLabel->
  "In[834]:=",ExpressionUUID->"abf6a1f9-1397-4a1e-b891-fb46b3f39357"],

Cell["Calculate the electron QFL and QFL splitting", "Text",
 CellChangeTimes->{{3.9739558541389065`*^9, 3.9739558618046856`*^9}, {
  3.973958314747759*^9, 
  3.9739583179982834`*^9}},ExpressionUUID->"38b9c72d-95df-ef4d-b557-\
9a40ffdc75c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ln", "[", "p_", "]"}], ":=", 
    RowBox[{"1.7", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "4"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p", "/", 
        SuperscriptBox["10", "19"]}], ")"}], 
      RowBox[{"-", "0.4"}]]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"doi", ".", "org"}], "/", "10.1063"}], "/", "1.109997"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ln\[LetterSpace]emit", "=", 
   RowBox[{"Ln", "[", "p\[LetterSpace]emit", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9739558713122063`*^9, 3.973955882452635*^9}, {
  3.9739574718149223`*^9, 3.973957511172001*^9}, {3.9739575422783184`*^9, 
  3.9739576586687737`*^9}},
 CellLabel->
  "In[837]:=",ExpressionUUID->"94a5f6fc-4385-8d41-a979-41c4dfaa80ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n\[LetterSpace]edge", "[", "v_", "]"}], ":=", 
   RowBox[{"nc", "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"eg\[LetterSpace]emit", "-", 
         RowBox[{"(", 
          RowBox[{"efp", "+", "v"}], ")"}]}], ")"}]}], "/", "kBT"}], 
     "]"}]}]}], 
  RowBox[{"(*", 
   RowBox[{
   "electron", " ", "density", " ", "at", " ", "edge", " ", "of", " ", 
    "depletion"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"srv", "==", "\"\<zero\>\""}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"efn", "[", 
       RowBox[{"x_", ",", "v_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"kBT", "*", 
        RowBox[{"Log", "[", 
         RowBox[{
          FractionBox["1", "nc"], "+", 
          RowBox[{
           FractionBox[
            RowBox[{"n\[LetterSpace]edge", "[", "v", "]"}], "nc"], 
           RowBox[{"Cosh", "[", 
            FractionBox["x", "Ln\[LetterSpace]emit"], "]"}], 
           RowBox[{"Sech", "[", 
            FractionBox["We", "Ln\[LetterSpace]emit"], "]"}]}]}], "]"}]}], "+",
        "eg\[LetterSpace]emit"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"electron", " ", "QFL", " ", "through", " ", "emitter"}], ",", 
       " ", 
       RowBox[{"assumes", " ", "no", " ", "surface", " ", "recombination"}], ",",
        " ", 
       RowBox[{
       "1", " ", "is", " ", "for", " ", "numeric", " ", "stability"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"jsurf", "[", "v_", "]"}], ":=", "0"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"efn", "[", 
       RowBox[{"x_", ",", "v_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"kBT", "*", 
        RowBox[{"Log", "[", 
         RowBox[{
          FractionBox["1", "nc"], "+", 
          RowBox[{
           FractionBox[
            RowBox[{"n\[LetterSpace]edge", "[", "v", "]"}], "nc"], 
           RowBox[{"Sinh", "[", 
            FractionBox["x", "Ln\[LetterSpace]emit"], "]"}], 
           RowBox[{"Csch", "[", 
            FractionBox["We", "Ln\[LetterSpace]emit"], "]"}]}]}], "]"}]}], "+",
        "eg\[LetterSpace]emit"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"jsurf", "[", "v_", "]"}], ":=", 
      RowBox[{"q", "*", "Dn", "*", 
       RowBox[{"n\[LetterSpace]edge", "[", "v", "]"}], "*", 
       RowBox[{
        RowBox[{"Csch", "[", 
         RowBox[{"We", "/", "Ln\[LetterSpace]emit"}], "]"}], "/", 
        "Ln\[LetterSpace]emit"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.973957671871605*^9, 3.973957691380171*^9}, {
  3.973957735255083*^9, 3.9739578391017036`*^9}, {3.973957898240242*^9, 
  3.973957924645441*^9}, {3.9739580662390556`*^9, 3.9739581329652576`*^9}, {
  3.9739653768278675`*^9, 3.9739653884081097`*^9}, {3.973966242411808*^9, 
  3.973966248433895*^9}, {3.9739667263285847`*^9, 3.973966807072609*^9}},
 CellLabel->
  "In[839]:=",ExpressionUUID->"4500b5bf-9bf1-594f-9bf8-41e9ab70bc6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]\[Mu]", "[", 
   RowBox[{"x_", ",", "v_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"efn", "[", 
    RowBox[{"x", ",", "v"}], "]"}], "-", "efp"}]}]], "Input",
 CellChangeTimes->{{3.973958321333559*^9, 3.9739583417947083`*^9}},
 CellLabel->
  "In[841]:=",ExpressionUUID->"3db3bdfe-cafb-6045-bab1-e0119b7c34d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"jsurf", "[", "0.95", "]"}]], "Input",
 CellChangeTimes->{{3.97396639784042*^9, 3.973966450791437*^9}},
 CellLabel->
  "In[842]:=",ExpressionUUID->"7c0fdd2c-e3d5-5845-b386-1de3ccc12417"],

Cell[BoxData["0.4567757198815856`"], "Output",
 CellChangeTimes->{{3.9739664016110973`*^9, 3.973966451175457*^9}, 
   3.973966512857233*^9, 3.9739670642570267`*^9, 3.973967121858406*^9, 
   3.9739674513095913`*^9, 3.973968193062338*^9},
 CellLabel->
  "Out[842]=",ExpressionUUID->"d7d5f5dd-c18c-9e40-8462-9324a9082397"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation settings", "Subsection",
 CellChangeTimes->{{3.9737036594012537`*^9, 3.9737036630397806`*^9}, {
  3.973704411517503*^9, 
  3.9737044142202215`*^9}},ExpressionUUID->"080fba45-0359-4a3f-b6b8-\
5a7d7dfd9520"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dv", "=", "0.001"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Finite", " ", "difference", " ", "to", " ", "use", " ", "for", " ", 
    "calculating", " ", "ideality", " ", "factors", " ", "and", " ", "for", " ",
     "getting", " ", "jsc", " ", "to", " ", "converge"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jl", "=", 
    RowBox[{"-", "30"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Photocurrent", ".", " ", "Adopt"}], " ", "convention", " ", 
    "that", " ", "forward", " ", "bias", " ", "is", " ", "positive", " ", 
    "diode", " ", "current"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"psun", " ", "=", " ", "100"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"AM1", ".5", "G"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e0", "=", "0"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"grid", " ", "settings", " ", "for", " ", "pre"}], "-", 
    RowBox[{"computing", " ", "absorption", " ", "coefficient"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"emax", "=", "eg\[LetterSpace]emit"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"de", "=", "0.005"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]\[Mu]0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]\[Mu]max", "=", "emax"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[CapitalDelta]\[Mu]", "=", "0.005"}], ";"}]}], "Input",
 CellChangeTimes->{{3.973703665202937*^9, 3.973703715120788*^9}, {
   3.9737037835621243`*^9, 3.973703831616153*^9}, {3.9737043891741495`*^9, 
   3.973704450787842*^9}, {3.9737052693776445`*^9, 3.9737052867923727`*^9}, 
   3.973794946933134*^9, {3.9737950696329947`*^9, 3.9737950704929667`*^9}, {
   3.9738633402154517`*^9, 3.9738634446291304`*^9}, {3.9738635220419164`*^9, 
   3.9738635925696354`*^9}, {3.9738639067199554`*^9, 
   3.9738639087354217`*^9}, {3.9738656277790737`*^9, 3.973865653065094*^9}, {
   3.9738659843027563`*^9, 3.9738659879148445`*^9}, {3.973958220900711*^9, 
   3.9739582215341682`*^9}, {3.9739598275069237`*^9, 3.973959833341961*^9}},
 CellLabel->
  "In[843]:=",ExpressionUUID->"1d3980ff-d7a5-4a25-8a3f-83d32b4e1188"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Helper Functions", "Subsection",
 CellChangeTimes->{{3.9737043786213765`*^9, 
  3.973704380557405*^9}},ExpressionUUID->"88894a74-1ab3-4c0d-a95c-\
572659088658"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"calc\[LetterSpace]pmax", "[", "j_", "]"}], ":=", " ", 
  RowBox[{"NMaximize", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "x"}], "*", 
     RowBox[{"j", "[", "x", "]"}]}], ",", "x", ",", 
    RowBox[{"PrecisionGoal", "->", "4"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calc\[LetterSpace]eff", "[", "j_", "]"}], ":=", 
  RowBox[{
   RowBox[{"calc\[LetterSpace]pmax", "[", "j", "]"}], "/", "psun"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calc\[LetterSpace]jsc", "[", "j_", "]"}], ":=", 
  RowBox[{"j", "[", "0", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calc\[LetterSpace]voc", "[", "j_", "]"}], ":=", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "[", "x", "]"}], "==", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "1"}], "}"}], ",", 
    RowBox[{"PrecisionGoal", "->", "4"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calc\[LetterSpace]ff", "[", "j_", "]"}], ":=", 
  RowBox[{
   RowBox[{"calc\[LetterSpace]pmax", "[", "j", "]"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"calc\[LetterSpace]jsc", "[", "j", "]"}], "*", 
     RowBox[{"calc\[LetterSpace]voc", "[", "j", "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calc\[LetterSpace]ideality", "[", 
   RowBox[{"j_", ",", "v_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["kBT", 
    RowBox[{"-", "1"}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"j", "[", 
          RowBox[{"v", "+", "dv"}], "]"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"j", "[", "v", "]"}], "]"}]}], ")"}], "/", "dv"}], ")"}], 
    RowBox[{"-", "1"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calc\[LetterSpace]pv", "[", "j_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cell\[LetterSpace]pmax", ",", "cell\[LetterSpace]eff", ",", 
      "cell\[LetterSpace]jsc", ",", "cell\[LetterSpace]voc", ",", 
      "cell\[LetterSpace]ff", ",", "cell\[LetterSpace]vmpp", ",", 
      "cell\[LetterSpace]jmpp", ",", "cell\[LetterSpace]ideal", ",", "pmax", ",",
       " ", "vmpp", ",", " ", "jmpp", ",", " ", "eff", ",", " ", "jsc", ",", 
      " ", "voc", ",", " ", "ff", ",", " ", "ideal"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cell\[LetterSpace]pmax", "=", 
      RowBox[{"calc\[LetterSpace]pmax", "[", "j", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cell\[LetterSpace]vmpp", "=", 
      RowBox[{"cell\[LetterSpace]pmax", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cell\[LetterSpace]pmax", "=", 
      RowBox[{"cell\[LetterSpace]pmax", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cell\[LetterSpace]jmpp", " ", "=", " ", 
      RowBox[{"j", "[", "cell\[LetterSpace]vmpp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cell\[LetterSpace]eff", "=", 
      RowBox[{"cell\[LetterSpace]pmax", "/", "psun"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cell\[LetterSpace]jsc", "=", 
      RowBox[{"-", 
       RowBox[{"calc\[LetterSpace]jsc", "[", "j", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cell\[LetterSpace]voc", "=", 
      RowBox[{
       RowBox[{"calc\[LetterSpace]voc", "[", "j", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cell\[LetterSpace]ff", "=", 
      RowBox[{"cell\[LetterSpace]pmax", "/", 
       RowBox[{"(", 
        RowBox[{"cell\[LetterSpace]jsc", "*", "cell\[LetterSpace]voc"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<pmax\>\"", "->", "cell\[LetterSpace]pmax"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<vmpp\>\"", "->", "cell\[LetterSpace]vmpp"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<jmpp\>\"", "->", "cell\[LetterSpace]jmpp"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<eff\>\"", "->", "cell\[LetterSpace]eff"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<jsc\>\"", "->", "cell\[LetterSpace]jsc"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<voc\>\"", "->", "cell\[LetterSpace]voc"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<ff\>\"", "->", "cell\[LetterSpace]ff"}]}], "|>"}], 
      "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.97370447220057*^9, 3.9737044735092487`*^9}, {
   3.9737049585724096`*^9, 3.9737049670194073`*^9}, {3.973705091713151*^9, 
   3.9737051366651397`*^9}, {3.9737051843780766`*^9, 
   3.9737052542086344`*^9}, {3.9737052951762557`*^9, 
   3.9737053058329964`*^9}, {3.9737067389690046`*^9, 
   3.9737067395120907`*^9}, {3.9737068028896255`*^9, 3.973706963752351*^9}, {
   3.9737070121366515`*^9, 3.9737070146070004`*^9}, {3.9737945484750304`*^9, 
   3.9737945582816067`*^9}, {3.9737946179664793`*^9, 3.973794631982315*^9}, {
   3.9737946863665485`*^9, 3.973794765002504*^9}, {3.9737948083674*^9, 
   3.9737948175157814`*^9}, {3.9738016112928033`*^9, 3.9738016191965895`*^9}, 
   3.973802158967477*^9, {3.9738023007636604`*^9, 3.9738023436983433`*^9}, {
   3.973802457386066*^9, 3.9738024652834005`*^9}, {3.9738025227558155`*^9, 
   3.97380252293435*^9}, {3.9738029858403945`*^9, 3.9738029885142746`*^9}, {
   3.9738032565606103`*^9, 3.973803304686913*^9}, {3.973803436531227*^9, 
   3.973803632353709*^9}, {3.973803684264509*^9, 3.9738036928656445`*^9}, {
   3.973803850432939*^9, 3.9738039999015985`*^9}, {3.9738040671589465`*^9, 
   3.973804286320986*^9}, {3.973804318005698*^9, 3.973804350011451*^9}, {
   3.973804391038183*^9, 3.9738044787225046`*^9}, {3.9738045466220207`*^9, 
   3.973804551006897*^9}, 3.973863189340858*^9, {3.9738632275516305`*^9, 
   3.9738632301522245`*^9}, 3.973863272952443*^9, {3.9739598441200027`*^9, 
   3.9739598509942455`*^9}, 3.9739605511137714`*^9, {3.973961261537359*^9, 
   3.9739612728329544`*^9}},
 CellLabel->
  "In[852]:=",ExpressionUUID->"3b636752-49b2-4b8f-bad6-c588db5a492e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Depletion and Base Current", "Section",
 CellChangeTimes->{{3.973703740215469*^9, 
  3.9737037465602536`*^9}},ExpressionUUID->"9674d216-abbb-4ef4-a309-\
bbe32061f569"],

Cell[BoxData[
 RowBox[{
  RowBox[{"jdb\[LetterSpace]dark", "[", "v_", "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"v", "==", "0"}]}], "}"}], "}"}], ",", 
    RowBox[{"q", " ", "cbb", " ", 
     SuperscriptBox["ni", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Wd", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"v", "/", "kBT"}], "]"}], "-", "1"}], ")"}]}], "-", "Lp", "+", 
       RowBox[{"Lp", 
        FractionBox[
         StyleBox["kBT",
          FontWeight->"Plain"], "v"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"v", "/", "kBT"}], "]"}], "-", "1"}], ")"}]}]}], ")"}]}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.9737037714204044`*^9, 3.973703777136454*^9}, {
  3.9737038109364953`*^9, 3.9737038548552356`*^9}, {3.973704018815666*^9, 
  3.973704079599154*^9}, {3.973704232230711*^9, 3.9737042751008563`*^9}, {
  3.97370751688482*^9, 3.97370752866028*^9}, {3.973794985418929*^9, 
  3.9737949905721874`*^9}, {3.9739605041064873`*^9, 3.973960539824375*^9}, {
  3.973960576010195*^9, 3.973960592444689*^9}},
 CellLabel->
  "In[859]:=",ExpressionUUID->"003e1bfb-8099-4595-aa65-b70518309e51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"jdb\[LetterSpace]light", "[", "v_", "]"}], ":=", 
  RowBox[{"jl", "+", 
   RowBox[{"jdb\[LetterSpace]dark", "[", "v", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9737949927830095`*^9, 3.973795009744525*^9}},
 CellLabel->
  "In[860]:=",ExpressionUUID->"f90497cf-3e4a-4be9-b693-65ced43d09db"],

Cell["Reproduce a good GaAs cell photovoltaic parameters", "Text",
 CellChangeTimes->{{3.9737070731336575`*^9, 
  3.9737070850774612`*^9}},ExpressionUUID->"d8780429-6bad-4430-840f-\
d47b9beaaabf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"good\[LetterSpace]pv", "=", 
  RowBox[{"calc\[LetterSpace]pv", "[", "jdb\[LetterSpace]light", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"calc\[LetterSpace]ideality", "[", 
  RowBox[{"jdb\[LetterSpace]dark", ",", 
   RowBox[{"good\[LetterSpace]pv", "[", "\"\<vmpp\>\"", "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9737069844257092`*^9, 3.9737070063673983`*^9}, {
  3.973794777740697*^9, 3.973794785592298*^9}, {3.97379501690005*^9, 
  3.973795032300596*^9}, {3.973802379504105*^9, 3.973802387895745*^9}, {
  3.97380248263853*^9, 3.9738024829473453`*^9}, {3.973804297730673*^9, 
  3.97380430859265*^9}, {3.9738044988406105`*^9, 3.973804503408655*^9}, {
  3.9738632460389056`*^9, 3.973863246263464*^9}},
 CellLabel->
  "In[861]:=",ExpressionUUID->"651fd9d6-3130-438e-9078-f5f93fa90f23"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"pmax\"\>", "\[Rule]", "30.131524701677584`"}], ",", 
   RowBox[{"\<\"vmpp\"\>", "\[Rule]", "1.02995944365032`"}], ",", 
   RowBox[{"\<\"jmpp\"\>", "\[Rule]", 
    RowBox[{"-", "29.255059398151886`"}]}], ",", 
   RowBox[{"\<\"eff\"\>", "\[Rule]", "0.30131524701677587`"}], ",", 
   RowBox[{"\<\"jsc\"\>", "\[Rule]", "30"}], ",", 
   RowBox[{"\<\"voc\"\>", "\[Rule]", "1.126796505136697`"}], ",", 
   RowBox[{"\<\"ff\"\>", "\[Rule]", "0.891362506134805`"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.9737069883788404`*^9, 3.9737070552856665`*^9}, 
   3.973707540816062*^9, 3.9737085100506163`*^9, 3.973709592225494*^9, 
   3.9737108046038203`*^9, {3.9737110082954273`*^9, 3.9737110339129214`*^9}, 
   3.973711350666957*^9, 3.9737115239450245`*^9, 3.9737115788649006`*^9, 
   3.9737120702972364`*^9, 3.9737121561007223`*^9, 3.9737122592225523`*^9, 
   3.973712440873843*^9, 3.973712830951519*^9, 3.9737130395690536`*^9, 
   3.973713071709195*^9, 3.973794316126691*^9, 3.973794349809654*^9, 
   3.973794450289869*^9, 3.9737947868562903`*^9, 3.9737948215015583`*^9, {
   3.9737950272460356`*^9, 3.9737950331100597`*^9}, 3.973795074626647*^9, 
   3.9737954598326693`*^9, 3.973795756830019*^9, 3.9737958060963755`*^9, 
   3.9737995727643385`*^9, 3.9738002053394423`*^9, 3.9738008787676277`*^9, 
   3.9738009874783325`*^9, 3.9738016241259527`*^9, {3.9738023544316516`*^9, 
   3.973802388547496*^9}, {3.973802471727072*^9, 3.9738024841785808`*^9}, {
   3.973802527283794*^9, 3.9738025317207785`*^9}, 3.973803307903433*^9, {
   3.9738043097345123`*^9, 3.973804352600562*^9}, {3.973804398007018*^9, 
   3.9738044450569315`*^9}, {3.9738044912516613`*^9, 3.9738045042992673`*^9}, 
   3.9738045554745007`*^9, 3.973863177906361*^9, {3.973863239122609*^9, 
   3.973863277765122*^9}, 3.9738834787248936`*^9, 3.973958267342615*^9, 
   3.9739586528259773`*^9, 3.973959419593113*^9, 3.9739598578820553`*^9, 
   3.973959949190716*^9, 3.9739605558492985`*^9, {3.9739605860733795`*^9, 
   3.9739605953093624`*^9}, 3.973960984238821*^9, 3.9739612926476135`*^9, 
   3.973961617595375*^9, 3.9739639576087*^9, 3.9739642668612785`*^9, 
   3.9739645661401463`*^9, 3.973964892771826*^9, 3.973966512916519*^9, 
   3.973967121909807*^9, 3.973967451361149*^9, 3.9739681931100407`*^9},
 CellLabel->
  "Out[861]=",ExpressionUUID->"59278922-e600-2d49-bab9-fd86a6def2fa"],

Cell[BoxData["1.014163450079922`"], "Output",
 CellChangeTimes->{{3.9737069883788404`*^9, 3.9737070552856665`*^9}, 
   3.973707540816062*^9, 3.9737085100506163`*^9, 3.973709592225494*^9, 
   3.9737108046038203`*^9, {3.9737110082954273`*^9, 3.9737110339129214`*^9}, 
   3.973711350666957*^9, 3.9737115239450245`*^9, 3.9737115788649006`*^9, 
   3.9737120702972364`*^9, 3.9737121561007223`*^9, 3.9737122592225523`*^9, 
   3.973712440873843*^9, 3.973712830951519*^9, 3.9737130395690536`*^9, 
   3.973713071709195*^9, 3.973794316126691*^9, 3.973794349809654*^9, 
   3.973794450289869*^9, 3.9737947868562903`*^9, 3.9737948215015583`*^9, {
   3.9737950272460356`*^9, 3.9737950331100597`*^9}, 3.973795074626647*^9, 
   3.9737954598326693`*^9, 3.973795756830019*^9, 3.9737958060963755`*^9, 
   3.9737995727643385`*^9, 3.9738002053394423`*^9, 3.9738008787676277`*^9, 
   3.9738009874783325`*^9, 3.9738016241259527`*^9, {3.9738023544316516`*^9, 
   3.973802388547496*^9}, {3.973802471727072*^9, 3.9738024841785808`*^9}, {
   3.973802527283794*^9, 3.9738025317207785`*^9}, 3.973803307903433*^9, {
   3.9738043097345123`*^9, 3.973804352600562*^9}, {3.973804398007018*^9, 
   3.9738044450569315`*^9}, {3.9738044912516613`*^9, 3.9738045042992673`*^9}, 
   3.9738045554745007`*^9, 3.973863177906361*^9, {3.973863239122609*^9, 
   3.973863277765122*^9}, 3.9738834787248936`*^9, 3.973958267342615*^9, 
   3.9739586528259773`*^9, 3.973959419593113*^9, 3.9739598578820553`*^9, 
   3.973959949190716*^9, 3.9739605558492985`*^9, {3.9739605860733795`*^9, 
   3.9739605953093624`*^9}, 3.973960984238821*^9, 3.9739612926476135`*^9, 
   3.973961617595375*^9, 3.9739639576087*^9, 3.9739642668612785`*^9, 
   3.9739645661401463`*^9, 3.973964892771826*^9, 3.973966512916519*^9, 
   3.973967121909807*^9, 3.973967451361149*^9, 3.973968193113268*^9},
 CellLabel->
  "Out[862]=",ExpressionUUID->"3228607f-d074-a543-94b2-291f5b056281"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Emitter Current", "Section",
 CellChangeTimes->{{3.9737071188413167`*^9, 
  3.9737071271302633`*^9}},ExpressionUUID->"80cf27eb-e0c8-4841-b149-\
0c1ba137a12f"],

Cell["\<\
Integrand for calculating the Urbach absorption. Have already implicitly used \
Dirac function to integrate ec.\
\>", "Text",
 CellChangeTimes->{{3.973710111702523*^9, 3.9737101434134674`*^9}, {
  3.9737108210177913`*^9, 
  3.9737108226742735`*^9}},ExpressionUUID->"592a03b1-d84e-4493-98ec-\
eab7cd12d42d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]\[LetterSpace]integrand", "[", 
   RowBox[{"ev_", ",", "\[CapitalDelta]\[Mu]_", ",", "e_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Re", "[", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"-", "ev"}], "]"}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ev", "+", "e"}], ")"}], "/", "eu"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"fd", "[", 
      RowBox[{"ev", ",", "efp"}], "]"}], "-", 
     RowBox[{"fd", "[", 
      RowBox[{
       RowBox[{"ev", "+", "e"}], ",", 
       RowBox[{"efp", "+", "\[CapitalDelta]\[Mu]"}]}], "]"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.9737073293215036`*^9, 3.973707337566495*^9}, {
  3.973707399388988*^9, 3.9737074550362544`*^9}, {3.9737097415769286`*^9, 
  3.9737098272399874`*^9}, {3.973709863896516*^9, 3.973709864503703*^9}, {
  3.973710071630896*^9, 3.9737100803585687`*^9}, {3.9737101515653467`*^9, 
  3.9737101877577057`*^9}, {3.973712392054207*^9, 3.9737124109370766`*^9}, {
  3.9737978604911485`*^9, 3.9737978641430426`*^9}, {3.973799760274753*^9, 
  3.9737997606116133`*^9}, {3.9737999233719764`*^9, 3.9737999263595695`*^9}, {
  3.973800015039008*^9, 3.973800021006323*^9}, {3.973800379786047*^9, 
  3.973800380161803*^9}, {3.9738653165624447`*^9, 3.9738653203950257`*^9}},
 CellLabel->
  "In[863]:=",ExpressionUUID->"d79f1608-fb79-4eb3-b68e-8c741d809164"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]\[LetterSpace]factor", "=", 
   RowBox[{"\[Alpha]\[LetterSpace]bandgap", "/", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"\[Alpha]\[LetterSpace]integrand", "[", 
       RowBox[{"ev", ",", "0", ",", "eg\[LetterSpace]emit"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ev", ",", 
        RowBox[{"-", "Infinity"}], ",", "0"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9737118306440325`*^9, 3.973711893325921*^9}, {
   3.973794287987241*^9, 3.9737942996384916`*^9}, 3.9737997061832304`*^9, 
   3.9737998400728693`*^9},
 CellLabel->
  "In[864]:=",ExpressionUUID->"efa990fb-3961-463e-bc79-8398422e398f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]", "[", 
   RowBox[{
    RowBox[{"e_", "?", "NumericQ"}], ",", 
    RowBox[{"\[CapitalDelta]\[Mu]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"\[Alpha]\[LetterSpace]factor", " ", "*", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"\[Alpha]\[LetterSpace]integrand", "[", 
      RowBox[{"ev", ",", "\[CapitalDelta]\[Mu]", ",", "e"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ev", ",", 
       RowBox[{"-", "Infinity"}], ",", "0"}], "}"}], ",", 
     RowBox[{"PrecisionGoal", "->", "5"}], ",", 
     RowBox[{"AccuracyGoal", "->", "5"}], ",", 
     RowBox[{"MaxRecursion", "->", "20"}], ",", 
     RowBox[{"Method", "->", "\"\<LocalAdaptive\>\""}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.973709832788561*^9, 3.97370984263336*^9}, {
   3.97370988046506*^9, 3.9737098920635185`*^9}, {3.973709977528215*^9, 
   3.9737099775922117`*^9}, {3.973710212421813*^9, 3.9737102826450696`*^9}, {
   3.973711888742422*^9, 3.9737118893239*^9}, 3.9737122784618444`*^9, {
   3.9737124161618032`*^9, 3.973712417833744*^9}, {3.9737961125898447`*^9, 
   3.9737961194740806`*^9}, {3.9737961996237736`*^9, 
   3.9737962759961057`*^9}, {3.9737963253485208`*^9, 
   3.9737963267139673`*^9}, {3.973796406371908*^9, 3.973796490281486*^9}, {
   3.973799905742829*^9, 3.9737999060734577`*^9}, {3.9737999435817766`*^9, 
   3.973799944358841*^9}, {3.9737999966233807`*^9, 3.973800006549065*^9}, {
   3.9738003475350475`*^9, 3.9738003479224434`*^9}, {3.9738009522009544`*^9, 
   3.973800952633417*^9}, {3.9738651514022136`*^9, 3.9738651630524054`*^9}, 
   3.9738656928903694`*^9, 3.9738657645576134`*^9, 3.9738658015528994`*^9, {
   3.973865952104131*^9, 3.9738659535269337`*^9}, {3.9738843205195656`*^9, 
   3.9738843219521065`*^9}, {3.9739589170841293`*^9, 
   3.9739589490041294`*^9}, {3.9739590905610867`*^9, 3.973959098945978*^9}},
 CellLabel->
  "In[865]:=",ExpressionUUID->"6e8ae0b7-3f7b-4072-8609-53597d7329bb"],

Cell["\<\
Pre compute absorption spectra and turn into interpolating function\
\>", "Text",
 CellChangeTimes->{{3.9738633180174575`*^9, 
  3.9738633297824383`*^9}},ExpressionUUID->"7f9c9b39-1df8-4f86-aa7e-\
76daca72e2c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]\[LetterSpace]table", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Parallelize", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e", ",", "\[CapitalDelta]\[Mu]"}], "}"}], ",", 
          RowBox[{"\[Alpha]", "[", 
           RowBox[{"e", ",", "\[CapitalDelta]\[Mu]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\[CapitalDelta]\[Mu]", ",", "\[CapitalDelta]\[Mu]0", ",", 
          "\[CapitalDelta]\[Mu]max", ",", "d\[CapitalDelta]\[Mu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"e", ",", "e0", ",", "emax", ",", "de"}], "}"}]}], "]"}], 
      "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9738639406937594`*^9, 3.973864022012513*^9}, {
   3.973865208236903*^9, 3.9738652091637774`*^9}, {3.9738658111933823`*^9, 
   3.973865816102728*^9}, 3.973865867823991*^9, {3.973866124325859*^9, 
   3.973866126173091*^9}, {3.973883527103058*^9, 3.973883538701393*^9}, {
   3.973883860923952*^9, 3.973883868783209*^9}, {3.973884105695736*^9, 
   3.9738841155645447`*^9}},
 CellLabel->
  "In[866]:=",ExpressionUUID->"3a169ee2-00c6-4c1a-bc1e-8474c5674d3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Alpha]\[LetterSpace]interpf", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"\[Alpha]\[LetterSpace]table", ",", 
     RowBox[{"InterpolationOrder", "->", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]\[LetterSpace]interp", "[", 
    RowBox[{
     RowBox[{"e_", "?", "NumericQ"}], ",", 
     RowBox[{"\[CapitalDelta]\[Mu]_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"\[Alpha]\[LetterSpace]interpf", "[", 
    RowBox[{"e", ",", "\[CapitalDelta]\[Mu]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9738660561181374`*^9, 3.973866060877529*^9}, 
   3.9738661094349327`*^9, {3.9738835756721497`*^9, 3.973883687725151*^9}, 
   3.973883719943907*^9, {3.9738839131163063`*^9, 3.973883913927414*^9}, {
   3.973884020700775*^9, 3.9738840207748623`*^9}, {3.9738841612929325`*^9, 
   3.9738841613792343`*^9}},
 CellLabel->
  "In[867]:=",ExpressionUUID->"3e42ddac-8f0d-48d0-9a37-4255b8c3794a"],

Cell["Black body photon flux", "Text",
 CellChangeTimes->{{3.973710478787649*^9, 
  3.973710484452547*^9}},ExpressionUUID->"cc92f4ba-bde9-480e-a4f6-\
f57fce64f9fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"jbb", "[", 
   RowBox[{
    RowBox[{"e_", "?", "NumericQ"}], ",", 
    RowBox[{"\[CapitalDelta]\[Mu]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"8", "Pi", " ", 
     SuperscriptBox["n", "2"], "c"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"h", " ", "c"}], ")"}], "3"]], 
   SuperscriptBox["e", "2"], "*", 
   RowBox[{"be", "[", 
    RowBox[{"e", ",", "\[CapitalDelta]\[Mu]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9737104861513944`*^9, 3.9737105240756454`*^9}, {
  3.9737105733483925`*^9, 3.9737105801460123`*^9}, {3.9737124217115736`*^9, 
  3.973712422818043*^9}, {3.9738000492714148`*^9, 3.9738000513113747`*^9}, {
  3.9738009635391383`*^9, 3.973800964810855*^9}},
 CellLabel->
  "In[869]:=",ExpressionUUID->"a7217278-fda4-44d1-b999-9249402411d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"current\[LetterSpace]integrand", "[", 
   RowBox[{
    RowBox[{"e_", "?", "NumericQ"}], ",", 
    RowBox[{"\[CapitalDelta]\[Mu]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Alpha]\[LetterSpace]interp", "[", 
    RowBox[{"e", ",", "\[CapitalDelta]\[Mu]"}], "]"}], "*", 
   RowBox[{"jbb", "[", 
    RowBox[{"e", ",", "\[CapitalDelta]\[Mu]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9737106694087934`*^9, 3.973710715795084*^9}, {
   3.973712425853011*^9, 3.9737124269854145`*^9}, {3.973800045588892*^9, 
   3.9738000645987806`*^9}, {3.973800394784334*^9, 3.97380039572655*^9}, {
   3.973800966778073*^9, 3.9738009678983707`*^9}, {3.973884254847044*^9, 
   3.9738842839487343`*^9}, 3.973884326285267*^9},
 CellLabel->
  "In[870]:=",ExpressionUUID->"d13f7528-be08-4bf7-b161-54d4ce2316c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"emitter\[LetterSpace]current\[LetterSpace]density", "[", 
   RowBox[{"\[CapitalDelta]\[Mu]_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{"q", "*", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"current\[LetterSpace]integrand", "[", 
      RowBox[{"e", ",", "\[CapitalDelta]\[Mu]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", "0", ",", "eg\[LetterSpace]emit"}], "}"}], ",", 
     RowBox[{"PrecisionGoal", "->", "4"}], ",", 
     RowBox[{"MaxRecursion", "->", "20"}], ",", 
     RowBox[{"Method", "->", "\"\<LocalAdaptive\>\""}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9737122920616937`*^9, 3.9737123680112276`*^9}, 
   3.9737124315799513`*^9, {3.973794405938984*^9, 3.9737944074691353`*^9}, {
   3.9737952873215632`*^9, 3.973795291177114*^9}, {3.973795486284647*^9, 
   3.973795486403657*^9}, 3.973795728162552*^9, 3.973795784288048*^9, {
   3.973796599948867*^9, 3.973796683755628*^9}, {3.973800324525037*^9, 
   3.973800324866888*^9}, {3.9738009365694284`*^9, 3.973800937203557*^9}, 
   3.973884349120085*^9, 3.9739607386795063`*^9},
 CellLabel->
  "In[871]:=",ExpressionUUID->"6a6bce39-d8a9-4654-9804-045974523483"],

Cell[BoxData[
 RowBox[{
  RowBox[{"emitter\[LetterSpace]current", "[", 
   RowBox[{"v_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"emitter\[LetterSpace]current\[LetterSpace]density", "[", 
     RowBox[{"\[CapitalDelta]\[Mu]", "[", 
      RowBox[{"x", ",", "v"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "We"}], "}"}], ",", 
    RowBox[{"PrecisionGoal", "->", "4"}], ",", 
    RowBox[{"MaxRecursion", "->", "20"}], ",", 
    RowBox[{"Method", "->", "\"\<LocalAdaptive\>\""}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9737125490842314`*^9, 3.973712572168519*^9}, {
   3.9737127769199853`*^9, 3.9737128152089715`*^9}, 3.9737129251270447`*^9, {
   3.9737130491431417`*^9, 3.9737130494308147`*^9}, {3.9737130839186125`*^9, 
   3.973713105231762*^9}, {3.973794363944793*^9, 3.973794381923478*^9}, {
   3.973794428514189*^9, 3.9737944324917645`*^9}, {3.9737953510243587`*^9, 
   3.97379540867885*^9}, 3.9737954473008347`*^9, {3.9737954888679266`*^9, 
   3.973795489012355*^9}, 3.9737967443350725`*^9, {3.9737970874252768`*^9, 
   3.973797142747485*^9}, {3.9737972253144865`*^9, 3.97379722742268*^9}, {
   3.9737972647983522`*^9, 3.9737972665743504`*^9}, 3.9738009726410565`*^9, {
   3.9738843546704845`*^9, 3.9738843589994926`*^9}, {3.97395853620759*^9, 
   3.9739585400397816`*^9}, {3.97395858050593*^9, 3.9739585805653877`*^9}, 
   3.973960740613825*^9},
 CellLabel->
  "In[872]:=",ExpressionUUID->"593443a5-98a5-43f0-80cf-75f73cc007fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cellj\[LetterSpace]dark", "[", 
   RowBox[{"v_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"jdb\[LetterSpace]dark", "[", "v", "]"}], "+", 
   RowBox[{"emitter\[LetterSpace]current", "[", "v", "]"}], "+", 
   RowBox[{"jsurf", "[", "v", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellj\[LetterSpace]light", "[", 
   RowBox[{"v_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"cellj\[LetterSpace]dark", "[", "v", "]"}], "+", 
   "jl"}]}]}], "Input",
 CellChangeTimes->{{3.973800467230373*^9, 3.973800533262942*^9}, {
  3.9738009776497717`*^9, 3.973800978696948*^9}, {3.9739664666488914`*^9, 
  3.973966469304407*^9}},
 CellLabel->
  "In[873]:=",ExpressionUUID->"050c247b-fad2-44ec-b2ef-de490b2afdb6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cell\[LetterSpace]pv", "=", 
  RowBox[{"calc\[LetterSpace]pv", "[", "cellj\[LetterSpace]light", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cell\[LetterSpace]ideality", "=", 
  RowBox[{"calc\[LetterSpace]ideality", "[", 
   RowBox[{"cellj\[LetterSpace]dark", ",", 
    RowBox[{"cell\[LetterSpace]pv", "[", "\"\<vmpp\>\"", "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9738045801704893`*^9, 3.973804590266275*^9}, {
  3.9738046237577395`*^9, 3.9738046434621944`*^9}, {3.973884407886238*^9, 
  3.9738844094841843`*^9}, {3.9738844617998295`*^9, 3.973884462263027*^9}},
 CellLabel->
  "In[875]:=",ExpressionUUID->"d62f5e85-b15b-453f-8e8a-d75a62a75156"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "lstol", 
   "\"The line search decreased the step size to within tolerance specified \
by AccuracyGoal and PrecisionGoal but was unable to find a sufficient \
decrease in the merit function. You may need more than \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) digits of working precision to \
meet these tolerances.\"", 2, 875, 15, 29291565574711164498, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9739686375879326`*^9},
 CellLabel->
  "During evaluation of \
In[875]:=",ExpressionUUID->"9e5efc03-75e1-b441-972e-487ce6398363"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"pmax\"\>", "\[Rule]", "18.71680540550027`"}], ",", 
   RowBox[{"\<\"vmpp\"\>", "\[Rule]", "0.670666464935543`"}], ",", 
   RowBox[{"\<\"jmpp\"\>", "\[Rule]", 
    RowBox[{"-", "27.907769933448392`"}]}], ",", 
   RowBox[{"\<\"eff\"\>", "\[Rule]", "0.1871680540550027`"}], ",", 
   RowBox[{"\<\"jsc\"\>", "\[Rule]", "29.978519851798726`"}], ",", 
   RowBox[{"\<\"voc\"\>", "\[Rule]", "0.8048700332535859`"}], ",", 
   RowBox[{"\<\"ff\"\>", "\[Rule]", "0.7757035529164116`"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.9738202237168627`*^9, 3.9738843858089867`*^9, 
  3.97388444311582*^9, 3.9738844973427353`*^9, 3.973884641611471*^9, 
  3.9739586108482475`*^9, 3.9739588648949413`*^9, 3.973959408150625*^9, 
  3.973959698414818*^9, 3.973959918340473*^9, 3.9739604185792904`*^9, 
  3.9739607571288204`*^9, 3.97396119298682*^9, 3.973961568973028*^9, 
  3.9739619040752525`*^9, 3.973964220622074*^9, 3.973964519365114*^9, 
  3.9739648425583534`*^9, 3.973965138423395*^9, 3.9739669536100407`*^9, 
  3.9739670870803623`*^9, 3.9739673792738247`*^9, 3.973968127742937*^9, 
  3.9739686375983315`*^9},
 CellLabel->
  "Out[875]=",ExpressionUUID->"cfc89381-0948-6746-9d19-1df2b95c752d"],

Cell[BoxData["1.9411939079692897`"], "Output",
 CellChangeTimes->{3.9738202237168627`*^9, 3.9738843858089867`*^9, 
  3.97388444311582*^9, 3.9738844973427353`*^9, 3.973884641611471*^9, 
  3.9739586108482475`*^9, 3.9739588648949413`*^9, 3.973959408150625*^9, 
  3.973959698414818*^9, 3.973959918340473*^9, 3.9739604185792904`*^9, 
  3.9739607571288204`*^9, 3.97396119298682*^9, 3.973961568973028*^9, 
  3.9739619040752525`*^9, 3.973964220622074*^9, 3.973964519365114*^9, 
  3.9739648425583534`*^9, 3.973965138423395*^9, 3.9739669536100407`*^9, 
  3.9739670870803623`*^9, 3.9739673792738247`*^9, 3.973968127742937*^9, 
  3.9739686381001186`*^9},
 CellLabel->
  "Out[876]=",ExpressionUUID->"a7ecdaa6-6be1-3745-aa06-071478cac2f7"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{478, 525.5},
WindowMargins->{{-484.5, Automatic}, {Automatic, 0}},
DockedCells->{},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e3a05148-4e35-c24c-acb1-4138708ec58e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 232, 4, 28, "Input",ExpressionUUID->"ab6e992b-1046-458c-b4e6-e0be4a679265"],
Cell[CellGroupData[{
Cell[815, 28, 213, 4, 60, "Chapter",ExpressionUUID->"78bb56e9-172b-4e6a-98b3-fc86e79d1da0"],
Cell[1031, 34, 333, 6, 55, "Text",ExpressionUUID->"1729ae9a-9b48-4d0b-a40e-d68569e85bdb"],
Cell[CellGroupData[{
Cell[1389, 44, 161, 3, 53, "Subsection",ExpressionUUID->"f813bb09-e934-4f0d-ba75-a3f0e3dbec09"],
Cell[1553, 49, 1305, 37, 142, "Input",ExpressionUUID->"9edb37a7-440e-4a5d-92e2-c30daf472362"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2895, 91, 165, 3, 53, "Subsection",ExpressionUUID->"ced1618c-5b4a-4b9e-bb84-d1cd46e1e0ca"],
Cell[3063, 96, 198, 3, 33, "Text",ExpressionUUID->"fef5613e-f248-46ee-9822-7bd3d802b46e"],
Cell[CellGroupData[{
Cell[3286, 103, 5801, 137, 449, "Input",ExpressionUUID->"b4e7fd5d-dfa2-462e-bced-2d151fbec9c8"],
Cell[9090, 242, 1196, 17, 32, "Output",ExpressionUUID->"09dba031-a9a8-704b-9e3e-8ead6e7ff53a"],
Cell[10289, 261, 1210, 17, 32, "Output",ExpressionUUID->"17767bdd-bbcd-214a-8af9-19f8b26d82ad"]
}, Open  ]],
Cell[11514, 281, 189, 3, 33, "Text",ExpressionUUID->"00098f11-d26d-439f-a371-182a42cbcffa"],
Cell[11706, 286, 1037, 30, 145, "Input",ExpressionUUID->"876e9714-ea10-413b-bb6a-ef29541e9d91"],
Cell[12746, 318, 220, 4, 33, "Text",ExpressionUUID->"4d4c98fe-72ac-4043-bb03-8f685ee0178f"],
Cell[12969, 324, 1150, 28, 107, "Input",ExpressionUUID->"d13148fa-bd05-4747-949f-807bd8f70983"],
Cell[CellGroupData[{
Cell[14144, 356, 1104, 22, 28, "Input",ExpressionUUID->"549ff1ab-b8fb-4e21-a4f0-a605c99ddf66"],
Cell[15251, 380, 614, 13, 99, "Message",ExpressionUUID->"58f76cbd-d52c-1d4f-a4ed-cd1193985f6c"],
Cell[15868, 395, 588, 12, 32, "Output",ExpressionUUID->"4e2d81f1-1868-6c4c-a75f-af714a02a436"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16505, 413, 165, 3, 53, "Subsection",ExpressionUUID->"e60a959f-3beb-4137-acf3-209d2ce9d572"],
Cell[16673, 418, 982, 29, 85, "Input",ExpressionUUID->"abf6a1f9-1397-4a1e-b891-fb46b3f39357"],
Cell[17658, 449, 241, 4, 33, "Text",ExpressionUUID->"38b9c72d-95df-ef4d-b557-9a40ffdc75c9"],
Cell[17902, 455, 909, 27, 68, "Input",ExpressionUUID->"94a5f6fc-4385-8d41-a979-41c4dfaa80ae"],
Cell[18814, 484, 3134, 83, 462, "Input",ExpressionUUID->"4500b5bf-9bf1-594f-9bf8-41e9ab70bc6a"],
Cell[21951, 569, 355, 9, 28, "Input",ExpressionUUID->"3db3bdfe-cafb-6045-bab1-e0119b7c34d3"],
Cell[CellGroupData[{
Cell[22331, 582, 209, 4, 28, "Input",ExpressionUUID->"7c0fdd2c-e3d5-5845-b386-1de3ccc12417"],
Cell[22543, 588, 319, 5, 32, "Output",ExpressionUUID->"d7d5f5dd-c18c-9e40-8462-9324a9082397"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22911, 599, 222, 4, 53, "Subsection",ExpressionUUID->"080fba45-0359-4a3f-b6b8-5a7d7dfd9520"],
Cell[23136, 605, 2260, 51, 256, "Input",ExpressionUUID->"1d3980ff-d7a5-4a25-8a3f-83d32b4e1188"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25433, 661, 166, 3, 53, "Subsection",ExpressionUUID->"88894a74-1ab3-4c0d-a95c-572659088658"],
Cell[25602, 666, 6233, 135, 599, "Input",ExpressionUUID->"3b636752-49b2-4b8f-bad6-c588db5a492e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31872, 806, 173, 3, 66, "Section",ExpressionUUID->"9674d216-abbb-4ef4-a309-bbe32061f569"],
Cell[32048, 811, 1300, 34, 146, "Input",ExpressionUUID->"003e1bfb-8099-4595-aa65-b70518309e51"],
Cell[33351, 847, 324, 7, 28, "Input",ExpressionUUID->"f90497cf-3e4a-4be9-b693-65ced43d09db"],
Cell[33678, 856, 196, 3, 33, "Text",ExpressionUUID->"d8780429-6bad-4430-840f-d47b9beaaabf"],
Cell[CellGroupData[{
Cell[33899, 863, 839, 14, 66, "Input",ExpressionUUID->"651fd9d6-3130-438e-9078-f5f93fa90f23"],
Cell[34741, 879, 2428, 37, 70, "Output",ExpressionUUID->"59278922-e600-2d49-bab9-fd86a6def2fa"],
Cell[37172, 918, 1902, 26, 32, "Output",ExpressionUUID->"3228607f-d074-a543-94b2-291f5b056281"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39123, 950, 164, 3, 66, "Section",ExpressionUUID->"80cf27eb-e0c8-4841-b149-0c1ba137a12f"],
Cell[39290, 955, 316, 7, 55, "Text",ExpressionUUID->"592a03b1-d84e-4493-98ec-eab7cd12d42d"],
Cell[39609, 964, 1392, 31, 66, "Input",ExpressionUUID->"d79f1608-fb79-4eb3-b68e-8c741d809164"],
Cell[41004, 997, 686, 16, 85, "Input",ExpressionUUID->"efa990fb-3961-463e-bc79-8398422e398f"],
Cell[41693, 1015, 1955, 35, 104, "Input",ExpressionUUID->"6e8ae0b7-3f7b-4072-8609-53597d7329bb"],
Cell[43651, 1052, 221, 5, 55, "Text",ExpressionUUID->"7f9c9b39-1df8-4f86-aa7e-76daca72e2c3"],
Cell[43875, 1059, 1250, 28, 104, "Input",ExpressionUUID->"3a169ee2-00c6-4c1a-bc1e-8474c5674d3d"],
Cell[45128, 1089, 978, 20, 85, "Input",ExpressionUUID->"3e42ddac-8f0d-48d0-9a37-4255b8c3794a"],
Cell[46109, 1111, 164, 3, 33, "Text",ExpressionUUID->"cc92f4ba-bde9-480e-a4f6-f57fce64f9fd"],
Cell[46276, 1116, 838, 21, 70, "Input",ExpressionUUID->"a7217278-fda4-44d1-b999-9249402411d1"],
Cell[47117, 1139, 840, 17, 47, "Input",ExpressionUUID->"d13f7528-be08-4bf7-b161-54d4ce2316c9"],
Cell[47960, 1158, 1184, 22, 85, "Input",ExpressionUUID->"6a6bce39-d8a9-4654-9804-045974523483"],
Cell[49147, 1182, 1511, 27, 85, "Input",ExpressionUUID->"593443a5-98a5-43f0-80cf-75f73cc007fd"],
Cell[50661, 1211, 769, 18, 66, "Input",ExpressionUUID->"050c247b-fad2-44ec-b2ef-de490b2afdb6"],
Cell[CellGroupData[{
Cell[51455, 1233, 681, 12, 66, "Input",ExpressionUUID->"d62f5e85-b15b-453f-8e8a-d75a62a75156"],
Cell[52139, 1247, 614, 13, 99, "Message",ExpressionUUID->"9e5efc03-75e1-b441-972e-487ce6398363"],
Cell[52756, 1262, 1266, 22, 70, "Output",ExpressionUUID->"cfc89381-0948-6746-9d19-1df2b95c752d"],
Cell[54025, 1286, 725, 11, 32, "Output",ExpressionUUID->"a7ecdaa6-6be1-3745-aa06-071478cac2f7"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

